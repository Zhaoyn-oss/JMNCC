% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/fJM.NCC.R
\name{fJM.NCC}
\alias{fJM.NCC}
\title{fJM-NCC: Likelihood inference with full maximum likelihood approach}
\usage{
fJM.NCC(
  obsObject,
  survObject,
  timeVar,
  deltaVar,
  CompRisk = TRUE,
  interFact,
  control = list()
)
}
\arguments{
\item{obsObject}{An \code{lmerMod} or \code{glmerMod} object (longitudinal sub-model).}

\item{survObject}{A \code{coxph} object (survival sub-model).}

\item{timeVar}{Character string for the time variable in the longitudinal data.}

\item{deltaVar}{Character string for the event indicator column in \code{interFact$data}, 0 representing control, k=1, 2... representing competing event k.}

\item{CompRisk}{Logical, whether to include competing risks (default \code{TRUE}).}

\item{interFact}{List with \code{value} (formula) and \code{data} (data frame) for additional covariates or strata.}

\item{control}{List of control parameters for quadrature points, tolerances, etc.}
}
\value{
A list of class \code{"JM.NCC"} with estimated coefficients, variance components, Hessian matrix, and other elements.
}
\description{
The fJM-NCC method incorporates all observed data and survival outcome, traeating the unobserved
longitudinal outcomes as missing at random. The longitudinal sub-model must be a
generalized linear mixed-effects model (\code{lmerMod} or \code{glmerMod}) and the survival sub-model can
be a Cox model (\code{coxph}) .
}
\details{
Constructs design matrices for longitudinal and survival sub-models, sets up
piecewise-constant baseline hazards, and performs joint likelihood estimation
using Gauss-Hermite and Gauss-Kronrod quadrature.
}
\examples{
\dontrun{
# load example data for linear mixed-effects model
data(obs_full_linear)
data(sur_full_linear)

# Convert survival data to long format for competing risks
full.surdata.long <- crLong(data = sur_full_linear, statusVar="event", censLevel = 1, nameStrata = "CR", nameStatus = "comp.event")

# Fit Cox model
survObject.full <- coxph(Surv(sur.time, comp.event) ~ gender+strata(CR), data = full.surdata.long, x = TRUE)

# Fit longitudinal model
obsObject.full <- lmer(obs.value~sample.time+(1+sample.time|subject), data=obs_full_linear)

# Fit joint model
res.fjm <- fJM.NCC(obsObject=obsObject.full, survObject=survObject.full, timeVar = "sample.time", deltaVar="delta", CompRisk=TRUE, interFact = list(value = ~ CR, data = full.surdata.long), control = list(Q=4))


# load example data for Poisson generalized linear mixed-effects model
data(obs_full_poisson)
data(sur_full_poisson)

obsObject.full <- glmer(obs.value~sample.time+(1+sample.time|subject), data=obs_full_poisson, family=poisson(link = "log"))
full.surdata.long <- crLong(data = sur_full_poisson, statusVar="event", censLevel = 1, nameStrata = "CR", nameStatus = "comp.event")
survObject.full <- coxph(Surv(sur.time, comp.event) ~ gender+strata(CR), data = full.surdata.long, x = TRUE)
res.fjm <- fJM.NCC(obsObject=obsObject.full, survObject=survObject.full, timeVar = "sample.time", deltaVar="delta", CompRisk=TRUE, interFact = list(value = ~ CR, data = full.surdata.long), control = list(Q=4))

}
}
